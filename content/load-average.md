+++
title = "CPU 平均工作负载"
date = 2020-08-22 22:48:39
[taxonomies]
tags = ["linux performance", "cpu performance"]
+++
当程序的性能未达到预期时，大多数开发者会选择使用 `top` 指令查看指标 `CPU` 使用率。其实，还有另一个有关 `CPU` 的重要指标: 平均负责 `(load average)`。

可以使用 `top` 指令，或者 `uptime` 指令查看:

``` bash
$top

top - 23:11:02 up 19 days, 12:05,  1 user,  load average: 1.25, 1.42, 1.29
Tasks: 258 total,   2 running, 197 sleeping,   0 stopped,   0 zombie
%Cpu(s):  9.1 us,  6.8 sy,  0.3 ni, 78.1 id,  5.2 wa,  0.0 hi,  0.5 si,  0.0 st
KiB Mem : 15871204 total,   508880 free,  1675924 used, 13686400 buff/cache
KiB Swap:  2097148 total,  2096112 free,     1036 used. 14133480 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 4812 root      20   0  271208 155208  36668 S  14.6  1.0   1078:57 rancher
...
```

``` bash
$ uptime
 23:10:12 up 19 days, 12:05,  1 user,  load average: 1.65, 1.50, 1.31
```

可以发现，`uptime` 指令的输出与 `top` 指令输出的第一行几乎一致。具体每一部分的含义为:

* **当前时间**: 23:10:12
* **运行时间**: up 19 days, 12:05
* **登录用户数量**: 1 user
* **平均负载**: 过去 **1min**，**3min**，**5min** 的平均负载

## 什么是平均负载

首先，需要强调:

* **平均负载不等于 `CPU` 使用率！！！**
* **平均负载不等于 `CPU` 使用率！！！**
* **平均负载不等于 `CPU` 使用率！！！**

而是，系统处于 **可运行状态** 和 **不可中断状态** 的平均进程数，即 **平均活跃进程数**。与 `CPU` 使用率没有直接关系。

* **可运行状态**: 正在使用 `CPU` 或者正在等待 `CPU` 的进程。即 `ps` 指令显示为 `R` 状态 `(Running/Runable)` 的进程。
* **不可中断状态**: 处于内核态关键流程中的进程，且不可打断。比如最常见的是等待硬件设备的 `I/O` 响应，即 `ps` 指令中中看到的 `D` 状态 `(Uninterruptible Sleep/Disk Sleep)` 的进程。

比如，当一个进程向磁盘读写数据时，为了保证数据的一致性，在得到磁盘回复前，它是不能被其他 **进程** 或者 **中断** 打断的，这个时候的进程就处于不可中断状态。如果此时的进程被打断了，就容易出现磁盘数据与进程数据不一致的问题。

所以，**不可中断状态实际上是系统对进程和硬件设备的一种保护机制**。

## 评估平均负载

可以简单的认为，平均负载就是活跃的进程数。所以，最理想的场景是每个 `CPU` 都只需要处理一个进程，即 `CPU` 数量等于平均负载值。

因此，在分析系统平均负载是否合理时，首先应该知道当前系统的 `CPU` 数量。

平均负载可以简单的认为是活跃进程数:

``` bash
$ cat /proc/cpuinfo | grep -i 'model name' | wc -l
16
```

之后，就可以通过比较 `CPU` 的数量与平均负载大小关系，确认系统是否过载。

同时，结合过去 `1min`，`5min`，`15min` 的系统负载，就可以推测出系统负载的变化趋势。

当平均负载超过 `CPU` `50%` 时，可以认为负载较高；当超过 `70%` 时，就应该开发分析导致高负载的原因。同时，也应该将平均负载作为一项监控指标。只有结合历史数据来分析才更有意义。

## 平均负载与 CPU 使用率

**平均负载** 表示为一定时间内，处于 **可运行状态** 和 **不可中断状态** 的进程数量。核心在于 **进程数量**。

* `R` 状态: 运行状态，会使用到 `CPU`
* `D` 状态: 不可中断状态，处于内核态等待 `I/O` 响应，不使用 `CPU`。

**`CPU` 使用率** 表示为一定时间内 `CPU` 的繁忙情况。核心在于进程占用 `CPU` 的时间占总时间的百分比。

因此，应该将二者结合一起使用:

* `CPU` 密集型进程，使用大量 `CPU` 会导致平均负载升高，此时这两者是一致的
* `I/O` 密集型进程，等待 `I/O` 会导致平均负载升高，但 `CPU` 使用率不一定很高
* 大量等待 `CPU` 的进程调度也会导致平均负载升高，此时的 `CPU` 使用率也会比较高。

## 案例分析

系统初始状态为:

``` bash
$ uptime
 16:39:57 up 1 day,  2:52,  0 users,  load average: 0.10, 0.05, 0.06
```

### 安装工具

``` bash
sudo pacman -S stress sysstat
```

### CPU 密集型

首先，在 `Terminal No.1` 使用 `stress` 模拟一个 `CPU` 密集型进程:

``` bash
$ stress --cpu 1 --timeout 6000
stress: info: [5049] dispatching hogs: 1 cpu, 0 io, 0 vm, 0 hdd
```

然后，在 `Terminal No.2` 查看平均负载:

``` bash
$ watch -d uptime
Every 2.0s: uptime                zephyrus: Sun Aug 23 16:44:30 2020

 16:44:30 up 1 day,  2:56,  0 users,  load average: 0.99, 0.62, 0.30
```

可以观察到，`1min` 的平均负载有较大的变化。

接着，在 `Terminal No.3` 监控 `CPU`:

``` bash
$ mpstat -P ALL 5
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

04:44:59 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
04:45:04 PM  all    6.29    0.00    0.06    0.00    0.00    0.08    0.00    0.00    0.00   93.57
04:45:04 PM    0    0.00    0.00    0.00    0.00    0.00    1.19    0.00    0.00    0.00   98.81
04:45:04 PM    1  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
04:45:04 PM    2    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
04:45:04 PM    3    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM    4    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM    5    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM    6    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
04:45:04 PM    7    0.40    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.60
04:45:04 PM    8    0.00    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.60
04:45:04 PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM   10    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
04:45:04 PM   11    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM   12    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
04:45:04 PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM   14    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
04:45:04 PM   15    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
```

`#1 CPU` 的 `%usr` 使用率为 `100。00`，而 `%sys` 与 `%iowait` 都是 `0.00`，说明 `#1 CPU` 正在处理 `CPU` 密集型的任务。

最后，在 `Terminal No.4` 中查找占用 `CPU` 的进程:

``` bash
$ pidstat -u 5 1
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

04:46:58 PM   UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
04:47:03 PM   977      5050  100.00    0.00    0.00    0.00  100.00     1  stress
04:47:03 PM   977      5054    0.00    0.20    0.00    0.00    0.20     4  watch

Average:      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
Average:      977      5050  100.00    0.00    0.00    0.00  100.00     -  stress
Average:      977      5054    0.00    0.20    0.00    0.00    0.20     -  watch
```

确认 `pid=5050` 的 `stress` 进程占用了 `100%` 的 `CPU`。

### I/O 密集型

等待一段时间，平均负载恢复正常之后。

首先，在 `Terminal No.1` 使用 `stress` 模拟一个 `I/O` 密集型进程:

``` bash
$ stress -i 1
stress: info: [7126] dispatching hogs: 0 cpu, 1 io, 0 vm, 0 hdd
```

然后，在 `Terminal No.2` 查看平均负载:

``` bash
$ watch -d uptime
Every 2.0s: uptime                zephyrus: Sun Aug 23 17:11:31 2020

 17:11:31 up 1 day,  3:23,  0 users,  load average: 0.98, 0.60, 0.54
```

`1min` 的平均负载有所增加。

接着，在 `Terminal No.3` 监控 `CPU`:

``` bash
$ mpstat -P ALL 5
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

05:11:53 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
05:11:58 PM  all    0.09    0.00    0.64    0.01    0.00    0.05    0.00    0.00    0.00   99.21
05:11:58 PM    0    0.00    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.59
05:11:58 PM    1    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM    2    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
05:11:58 PM    3    0.00    0.00    6.76    0.20    0.00    0.00    0.00    0.00    0.00   93.04
05:11:58 PM    4    0.00    0.00    0.43    0.00    0.00    0.65    0.00    0.00    0.00   98.92
05:11:58 PM    5    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
05:11:58 PM    6    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM    7    1.00    0.00    1.40    0.00    0.00    0.00    0.00    0.00    0.00   97.60
05:11:58 PM    8    0.00    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.60
05:11:58 PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM   10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM   11    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM   12    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
05:11:58 PM   14    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
05:11:58 PM   15    0.20    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.40
```

很遗憾，相比于 `CPU` 密集型的测试，`I/O` 本次测试的 `CPU` 变化不是特别明显。不过，还是可以发现 `#3 CPU` 的数据与其他 `CPU` 有一定的差别。

1. `%idle` 为 `93.04`，而其他的 `CPU` 该项数值均处于较高的水平
2. `%sys` 为 `6.76`，远高于其他 `CPU`
3. `%iowait` 为 `0.20`，相对于其他 `CPU` 最高只有 `0.01`，可谓是高出了 `2000%`

最后，使用 `pidstat` 查找具体进程:

``` bash
$ pidstat -u 5 1
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

05:13:36 PM   UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
05:13:41 PM   977      3196    0.20    0.00    0.00    0.00    0.20     7  node
05:13:41 PM   977      7127    0.00   15.00    0.00    0.20   15.00     3  stress

Average:      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
Average:      977      3196    0.20    0.00    0.00    0.00    0.20     -  node
Average:      977      7127    0.00   15.00    0.00    0.20   15.00     -  stress
```

发现 `stress` 进程的指标为 `%system = 15.00`，`%wait = 0.20`，`%CPU = 15.00`。

### 大量进程

因为，测试机有 16 个 `CPU` 核心，所以，在 `Terminal 1` 上模拟 `64` 个进程:

``` bash
$ stress -c 64 --timeout 6000
stress: info: [7847] dispatching hogs: 64 cpu, 0 io, 0 vm, 0 hdd
```

然后，在 `Terminal 2` 上查看平均负载:

``` bash
$ watch -d uptime
Every 2.0s: uptime                      zephyrus: Sun Aug 23 17:32:28 2020

 17:32:28 up 1 day,  3:44,  0 users,  load average: 62.89, 35.44, 14.80
```

接着，在 `Terminal 3` 查看 `CPU` 的状态:

``` bash
$ mpstat -P ALL 5
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

05:31:42 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
05:31:47 PM  all   99.92    0.00    0.07    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    0   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    1  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    2  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    3   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    4  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    5  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    6   99.60    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    7  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    8  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM    9  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   10  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   11  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   12   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   13  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   14   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
05:31:47 PM   15  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
```

所有的 `CPU` 都处于满负载工作状态，除了 `%usr` 之外，只有 `%sys` 有少量数值。

最后，在 `Terminal 4` 查看进程状态:

``` bash
$ pidstat -u 5 1
Linux 4.19.104-microsoft-standard (zephyrus)    08/23/2020      _x86_64_        (16 CPU)

05:33:00 PM   UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
05:33:05 PM   977      7848   25.00    0.00    0.00   75.00   25.00     4  stress
05:33:05 PM   977      7849   25.00    0.00    0.00   74.60   25.00     3  stress
05:33:05 PM   977      7850   25.00    0.00    0.00   74.40   25.00     9  stress
05:33:05 PM   977      7851   25.00    0.00    0.00   75.00   25.00    13  stress
05:33:05 PM   977      7852   25.00    0.00    0.00   75.20   25.00    15  stress
05:33:05 PM   977      7853   24.80    0.00    0.00   75.20   24.80     6  stress
05:33:05 PM   977      7854   24.80    0.20    0.00   75.40   25.00     0  stress
05:33:05 PM   977      7855   25.00    0.00    0.00   74.80   25.00     4  stress
05:33:05 PM   977      7856   25.00    0.00    0.00   75.20   25.00     6  stress
05:33:05 PM   977      7857   25.20    0.00    0.00   75.20   25.20     9  stress
05:33:05 PM   977      7858   25.00    0.00    0.00   75.00   25.00    10  stress
05:33:05 PM   977      7859   25.00    0.00    0.00   75.00   25.00    13  stress
05:33:05 PM   977      7860   25.00    0.00    0.00   75.00   25.00    15  stress
05:33:05 PM   977      7861   25.00    0.00    0.00   75.00   25.00     1  stress
05:33:05 PM   977      7863   25.00    0.00    0.00   75.00   25.00     5  stress
05:33:05 PM   977      7864   25.00    0.00    0.00   75.40   25.00     7  stress
05:33:05 PM   977      7865   25.00    0.00    0.00   75.00   25.00     3  stress
05:33:05 PM   977      7866   25.00    0.00    0.00   75.00   25.00    11  stress
05:33:05 PM   977      7867   24.80    0.00    0.00   75.00   24.80     2  stress
05:33:05 PM   977      7868   24.80    0.00    0.00   75.00   24.80    14  stress
05:33:05 PM   977      7869   25.00    0.00    0.00   74.80   25.00     0  stress
05:33:05 PM   977      7870   25.00    0.00    0.00   75.00   25.00     5  stress
05:33:05 PM   977      7871   25.00    0.00    0.00   74.40   25.00     6  stress
05:33:05 PM   977      7872   25.00    0.00    0.00   75.20   25.00     9  stress
05:33:05 PM   977      7873   24.80    0.00    0.00   75.40   24.80    10  stress
05:33:05 PM   977      7874   25.00    0.00    0.00   75.40   25.00    12  stress
05:33:05 PM   977      7875   25.00    0.00    0.00   75.00   25.00    15  stress
05:33:05 PM   977      7876   25.00    0.00    0.00   75.00   25.00     1  stress
05:33:05 PM   977      7877   24.60    0.20    0.00   75.00   24.80     2  stress
05:33:05 PM   977      7878   25.00    0.00    0.00   75.40   25.00     7  stress
05:33:05 PM   977      7879   24.80    0.00    0.00   75.60   24.80     8  stress
05:33:05 PM   977      7880   25.00    0.00    0.00   75.00   25.00    11  stress
05:33:05 PM   977      7881   25.00    0.00    0.00   75.00   25.00    12  stress
05:33:05 PM   977      7882   25.00    0.00    0.00   75.80   25.00    14  stress
05:33:05 PM   977      7883   25.20    0.00    0.00   74.80   25.20     1  stress
05:33:05 PM   977      7884   25.00    0.00    0.00   75.00   25.00     4  stress
05:33:05 PM   977      7885   25.00    0.00    0.00   75.20   25.00     6  stress
05:33:05 PM   977      7886   25.00    0.00    0.00   74.80   25.00     8  stress
05:33:05 PM   977      7887   25.00    0.00    0.00   75.40   25.00    11  stress
05:33:05 PM   977      7888   25.20    0.00    0.00   74.80   25.20    12  stress
05:33:05 PM   977      7889   24.80    0.00    0.00   75.20   24.80     2  stress
05:33:05 PM   977      7890   24.80    0.00    0.00   75.20   24.80     0  stress
05:33:05 PM   977      7891   25.00    0.00    0.00   74.80   25.00     5  stress
05:33:05 PM   977      7892   25.00    0.00    0.00   75.40   25.00     3  stress
05:33:05 PM   977      7893   25.00    0.00    0.00   74.80   25.00     8  stress
05:33:05 PM   977      7894   25.20    0.00    0.00   74.60   25.20    10  stress
05:33:05 PM   977      7895   25.00    0.00    0.00   75.20   25.00    13  stress
05:33:05 PM   977      7896   25.00    0.00    0.00   75.00   25.00    14  stress
05:33:05 PM   977      7897   24.80    0.00    0.00   75.60   24.80     2  stress
05:33:05 PM   977      7898   25.00    0.00    0.00   74.80   25.00     7  stress
05:33:05 PM   977      7899   24.80    0.00    0.00   75.20   24.80     8  stress
05:33:05 PM   977      7900   25.00    0.00    0.00   74.80   25.00    10  stress
05:33:05 PM   977      7901   25.00    0.00    0.00   74.80   25.00    13  stress
05:33:05 PM   977      7902   24.80    0.00    0.00   74.80   24.80    14  stress
05:33:05 PM   977      7903   24.80    0.00    0.00   75.20   24.80     1  stress
05:33:05 PM   977      7904   25.00    0.00    0.00   74.80   25.00     3  stress
05:33:05 PM   977      7905   24.80    0.00    0.00   75.00   24.80     4  stress
05:33:05 PM   977      7906   25.00    0.00    0.00   75.00   25.00     7  stress
05:33:05 PM   977      7907   24.80    0.00    0.00   75.00   24.80     9  stress
05:33:05 PM   977      7908   25.00    0.00    0.00   74.40   25.00    11  stress
05:33:05 PM   977      7909   25.00    0.00    0.00   75.20   25.00    12  stress
05:33:05 PM   977      7910   25.00    0.00    0.00   75.00   25.00    15  stress
05:33:05 PM   977      7911   25.00    0.00    0.00   74.80   25.00     0  stress
05:33:05 PM   977      7912   25.00    0.00    0.00   75.20   25.00     5  stress

Average:      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command
Average:      977      7848   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7849   25.00    0.00    0.00   74.60   25.00     -  stress
Average:      977      7850   25.00    0.00    0.00   74.40   25.00     -  stress
Average:      977      7851   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7852   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7853   24.80    0.00    0.00   75.20   24.80     -  stress
Average:      977      7854   24.80    0.20    0.00   75.40   25.00     -  stress
Average:      977      7855   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7856   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7857   25.20    0.00    0.00   75.20   25.20     -  stress
Average:      977      7858   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7859   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7860   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7861   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7863   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7864   25.00    0.00    0.00   75.40   25.00     -  stress
Average:      977      7865   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7866   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7867   24.80    0.00    0.00   75.00   24.80     -  stress
Average:      977      7868   24.80    0.00    0.00   75.00   24.80     -  stress
Average:      977      7869   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7870   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7871   25.00    0.00    0.00   74.40   25.00     -  stress
Average:      977      7872   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7873   24.80    0.00    0.00   75.40   24.80     -  stress
Average:      977      7874   25.00    0.00    0.00   75.40   25.00     -  stress
Average:      977      7875   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7876   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7877   24.60    0.20    0.00   75.00   24.80     -  stress
Average:      977      7878   25.00    0.00    0.00   75.40   25.00     -  stress
Average:      977      7879   24.80    0.00    0.00   75.60   24.80     -  stress
Average:      977      7880   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7881   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7882   25.00    0.00    0.00   75.80   25.00     -  stress
Average:      977      7883   25.20    0.00    0.00   74.80   25.20     -  stress
Average:      977      7884   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7885   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7886   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7887   25.00    0.00    0.00   75.40   25.00     -  stress
Average:      977      7888   25.20    0.00    0.00   74.80   25.20     -  stress
Average:      977      7889   24.80    0.00    0.00   75.20   24.80     -  stress
Average:      977      7890   24.80    0.00    0.00   75.20   24.80     -  stress
Average:      977      7891   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7892   25.00    0.00    0.00   75.40   25.00     -  stress
Average:      977      7893   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7894   25.20    0.00    0.00   74.60   25.20     -  stress
Average:      977      7895   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7896   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7897   24.80    0.00    0.00   75.60   24.80     -  stress
Average:      977      7898   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7899   24.80    0.00    0.00   75.20   24.80     -  stress
Average:      977      7900   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7901   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7902   24.80    0.00    0.00   74.80   24.80     -  stress
Average:      977      7903   24.80    0.00    0.00   75.20   24.80     -  stress
Average:      977      7904   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7905   24.80    0.00    0.00   75.00   24.80     -  stress
Average:      977      7906   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7907   24.80    0.00    0.00   75.00   24.80     -  stress
Average:      977      7908   25.00    0.00    0.00   74.40   25.00     -  stress
Average:      977      7909   25.00    0.00    0.00   75.20   25.00     -  stress
Average:      977      7910   25.00    0.00    0.00   75.00   25.00     -  stress
Average:      977      7911   25.00    0.00    0.00   74.80   25.00     -  stress
Average:      977      7912   25.00    0.00    0.00   75.20   25.00     -  stress
```

64 个进程，基本都占用了 `25%` 的 `CPU` 使用率。与设想中的一致，每个 `CPU` 核心要服务于 4 个进程。

## 参考阅读

[Linux的CPU-Load虚高之进程的D状态](https://jingwei.link/2018/12/23/linux-cpu-load-d-process.html)
[CPU使用率原理及计算方式](https://www.cnblogs.com/gatsby123/p/11127158.html)
[Linux 进程的 Uninterruptible sleep(D) 状态](https://www.cnblogs.com/xiaotengyi/p/7644336.html)
[Linux进程状态解析](https://blog.csdn.net/wudebao5220150/article/details/12919453)
